---
title: "Comparative Genomics Southern Flounder"
output:
  html_notebook:
    code_folding: hide
    df_print: paged
    highlight: kate
    theme: flatly
    toc: yes
  html_document:
    toc: yes
---

```{r load libraries, message=FALSE, warning=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

source("lib/libraries.R")
source("lib/ggplot.R")

```

# Compare family maps

Load family maps

```{r}

# FamA <- read.delim("data/LINKMAP/FamA.fullmap", 
#                    stringsAsFactors = FALSE, sep = "", 
#                    col.names = c("LG_FamA", "LOCUS", "POS_FamA"))
# 
# FamB <- read.delim("data/LINKMAP/FamB.fullmap", 
#                    stringsAsFactors = FALSE, sep = "", 
#                    col.names = c("LG_FamB", "LOCUS", "POS_FamB"))
# 
# temp <- inner_join(FamA, FamB, by = "LOCUS")
# 
# write.table(temp, "data/LINKMAP/shared.markers",
#             quote = FALSE, col.names = TRUE, row.names = FALSE)

```

Identify markers that are out of sequence. Remove from family maps and re-map each one.

```{r}

# change header names to Marker | Markertype | Genotype
FamB.onemap <- read.delim("data/LINKMAP/FamBfilter.onemap", 
                          header = FALSE, sep = " ",
                          col.names = c("LOCUS", "LOCUSTYPE", "GENOTYPE"),
                          skip = 1, stringsAsFactors = FALSE)

# number of individuals in dataset
N <- read.delim("data/LINKMAP/FamB.onemap", header = FALSE,
                          col.names = c("N_IND", "N_LOCI"),
                          nrows = 1, stringsAsFactors = FALSE)

# remove duplicate markers
Onemap.filt2 <- FamB.onemap %>%
  distinct(GENOTYPE, .keep_all = TRUE) %>%
  filter(!LOCUS %in% c("*dDocent_Contig_87392", 
                       "*dDocent_Contig_26999", 
                       "*dDocent_Contig_178968",
                       "*dDocent_Contig_30292",
                       "*dDocent_Contig_5988",
                       "*dDocent_Contig_3323",
                       "*dDocent_Contig_23004",
                       "*dDocent_Contig_23860",
                       "*dDocent_Contig_32599",
                       "*dDocent_Contig_97106",
                       "*dDocent_Contig_213871",
                       "*dDocent_Contig_3538",
                       "*dDocent_Contig_16570",
                       "*dDocent_Contig_50498",
                       "*dDocent_Contig_390204",
                       "*dDocent_Contig_21480",
                       "*dDocent_Contig_12831",
                       "*dDocent_Contig_14591",
                       "*dDocent_Contig_36117",
                       "*dDocent_Contig_30077",
                       "*dDocent_Contig_18146"))

# write filtered input file for Onemap
# need to add extra line back in
con <- file("data/LINKMAP/FamBfilter.onemap", open = "wt")
writeLines(paste(N$N_IND, (nrow(Onemap.filt2))), con)
write.table(Onemap.filt2, con, 
            append = FALSE, quote = FALSE, sep = " ", 
            na = "NA", dec = ".", 
            col.names = FALSE, row.names = FALSE)
close(con)

# import datafile
FamB.Map <- read.outcross(file="data/LINKMAP/FamBfilter.onemap")

# Summary of datafile
FamB.Map

# estimate recombination fraction between all pairs of markers
# creates object of class rf.2pts
FamB.Map.rf.L6.rf35 <- rf.2pts(FamB.Map, LOD = 6, max.rf = 0.35, verbose=TRUE)

# create sequence (list) of all markers to assign to LGs
all.markers <- make.seq(FamB.Map.rf.L6.rf35, "all") 

# assign markers to linkage groups
LGs <- group(all.markers, LOD = 6, max.rf = 0.35)

# define map function
set.map.fun(typ = "haldane")

# create list of separate LGs 
# (convert from class group to class sequence)
LG_list <- lapply(c(1:24), function(LG) {
  make.seq(LGs, LG)
})

# uses compare() to create a framework of most informative markers
# map remaining markers using try.seq()
# this step will take a few hours
LG_ordered <- lapply((LG_list), function(LG){
  order.seq(LG, n.init=6, THRES=3, touchdown=TRUE, tol=10e-2)
})

# create marker order with all markers
LG_final <- lapply((LG_ordered), function(LG){
  make.seq(LG, "force")
})
    
# group all final ordered LGs
FamB.map <- LG_final

# draw map for all LGs
draw.map(FamB.map, names=FALSE, grid=TRUE, cex.mrk=0.7)

# export map to file
write.map(FamB.map, "data/LINKMAP/FamB.fullmap")
FamB.fullmap <- read.table("data/LINKMAP/FamB.fullmap", 
                           skip = 1, header = FALSE) %>%
  mutate(LOCUS = paste(c("*"), V2, sep = "")) %>%
  rename(LG = V1, POSITION = V3) %>%
  select(LOCUS, LG, POSITION)

# create dataframe of removed loci and corresponding loci
match_loc <- anti_join(FamB.onemap, Onemap.filt2) %>%
  rename(MATCHLOC = LOCUS) %>%
  select(MATCHLOC, GENOTYPE) %>% 
  left_join(Onemap.filt2, by = "GENOTYPE") %>%
  select(LOCUS, MATCHLOC)

# add mapping positions
temp <- left_join(match_loc, FamB.fullmap, by = "LOCUS") %>%
  select(MATCHLOC, LG, POSITION) %>%
  rename(LOCUS = MATCHLOC)

# add markers to final map
FamB.fullmap <- bind_rows(FamB.fullmap, temp) %>%
  group_by(LG) %>%
  arrange(POSITION) %>%
  ungroup()

# write output to file
write.table(FamB.fullmap, "results/FamB.fullmap", row.names = FALSE)

## FamA

# change header names to Marker | Markertype | Genotype
FamA.onemap <- read.delim("data/LINKMAP/FamAfilter.onemap", 
                          header = FALSE, sep = " ",
                          col.names = c("LOCUS", "LOCUSTYPE", "GENOTYPE"),
                          skip = 1, stringsAsFactors = FALSE)

# number of individuals in dataset
N <- read.delim("data/LINKMAP/FamA.onemap", header = FALSE,
                          col.names = c("N_IND", "N_LOCI"),
                          nrows = 1, stringsAsFactors = FALSE)

# remove duplicate markers
Onemap.filt2 <- FamA.onemap %>%
  distinct(GENOTYPE, .keep_all = TRUE) %>%
  filter(!LOCUS %in% c("*dDocent_Contig_131586", 
                       "*dDocent_Contig_92423", 
                       "*dDocent_Contig_39533",
                       "*dDocent_Contig_23004",
                       "*dDocent_Contig_23860",
                       "*dDocent_Contig_12218",
                       "*dDocent_Contig_63085",
                       "*dDocent_Contig_305075",
                       "*dDocent_Contig_10702",
                       "*dDocent_Contig_83367",
                       "*dDocent_Contig_7091",
                       "*dDocent_Contig_248473",
                       "*dDocent_Contig_50498",
                       "*dDocent_Contig_21480",
                       "*dDocent_Contig_1694",
                       "*dDocent_Contig_642",
                       "*dDocent_Contig_12222",
                       "*dDocent_Contig_14784",
                       "*dDocent_Contig_1452",
                       "*dDocent_Contig_990",
                       "*dDocent_Contig_213918",
                       "*dDocent_Contig_182486",
                       "*dDocent_Contig_10808",
                       "*dDocent_Contig_26467",
                       "*dDocent_Contig_30202",
                       "*dDocent_Contig_9761",
                       "*dDocent_Contig_123370",
                       "*dDocent_Contig_52542"))

# write filtered input file for Onemap
# need to add extra line back in
con <- file("data/LINKMAP/FamAfilter.onemap", open = "wt")
writeLines(paste(N$N_IND, (nrow(Onemap.filt2))), con)
write.table(Onemap.filt2, con, 
            append = FALSE, quote = FALSE, sep = " ", 
            na = "NA", dec = ".", 
            col.names = FALSE, row.names = FALSE)
close(con)

# import datafile
FamA.Map <- read.outcross(file="data/LINKMAP/FamAfilter.onemap")

# Summary of datafile
FamA.Map

# estimate recombination fraction between all pairs of markers
# creates object of class rf.2pts
FamA.Map.rf.L6.rf35 <- rf.2pts(FamA.Map, LOD = 6, max.rf = 0.35, verbose=TRUE)

# create sequence (list) of all markers to assign to LGs
all.markers <- make.seq(FamA.Map.rf.L6.rf35, "all") 

# assign markers to linkage groups
LGs <- group(all.markers, LOD = 6, max.rf = 0.35)

# define map function
set.map.fun(typ = "haldane")

# create list of separate LGs 
# (convert from class group to class sequence)
LG_list <- lapply(c(1:24), function(LG) {
  make.seq(LGs, LG)
})

# uses compare() to create a framework of most informative markers
# map remaining markers using try.seq()
# this step will take a few hours
LG_ordered <- lapply((LG_list), function(LG){
  order.seq(LG, n.init=6, THRES=3, touchdown=TRUE, tol=10e-2)
})

# create marker order with all markers
LG_final <- lapply((LG_ordered), function(LG){
  make.seq(LG, "force")
})
    
# group all final ordered LGs
FamA.map <- LG_final

# draw map for all LGs
draw.map(FamA.map, names=FALSE, grid=TRUE, cex.mrk=0.7)

# export map to file
write.map(FamA.map, "data/LINKMAP/FamA.fullmap")
FamA.fullmap <- read.table("data/LINKMAP/FamA.fullmap", 
                           skip = 1, header = FALSE) %>%
  mutate(LOCUS = paste(c("*"), V2, sep = "")) %>%
  rename(LG = V1, POSITION = V3) %>%
  select(LOCUS, LG, POSITION)

# create dataframe of removed loci and corresponding loci
match_loc <- anti_join(FamA.onemap, Onemap.filt2) %>%
  rename(MATCHLOC = LOCUS) %>%
  select(MATCHLOC, GENOTYPE) %>% 
  left_join(Onemap.filt2, by = "GENOTYPE") %>%
  select(LOCUS, MATCHLOC)

# add mapping positions
temp <- left_join(match_loc, FamA.fullmap, by = "LOCUS") %>%
  select(MATCHLOC, LG, POSITION) %>%
  rename(LOCUS = MATCHLOC)

# add markers to final map
FamA.fullmap <- bind_rows(FamA.fullmap, temp) %>%
  group_by(LG) %>%
  arrange(POSITION) %>%
  ungroup()

# write output to file
write.table(FamA.fullmap, "results/FamA.fullmap", row.names = FALSE)


```


# Compare family maps after removing and re-mapping markers

Load family maps.

```{r}

FamA <- read.delim("data/LINKMAP/FamA.fullmap", 
                   stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG_FamA", "LOCUS", "POS_FamA"))

FamB <- read.delim("data/LINKMAP/FamB.fullmap", 
                   stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG_FamB", "LOCUS", "POS_FamB"))

temp <- inner_join(FamA, FamB, by = "LOCUS")

write.table(temp, "data/LINKMAP/shared.markers",
            quote = FALSE, col.names = TRUE, row.names = FALSE)

```

Compare family maps. Identify loci still out of sequence. Remove and re-map Family B map.

```{r}

# change header names to Marker | Markertype | Genotype
FamB.onemap <- read.delim("data/LINKMAP/FamBfilter.onemap", 
                          header = FALSE, sep = " ",
                          col.names = c("LOCUS", "LOCUSTYPE", "GENOTYPE"),
                          skip = 1, stringsAsFactors = FALSE)

# number of individuals in dataset
N <- read.delim("data/LINKMAP/FamB.onemap", header = FALSE,
                          col.names = c("N_IND", "N_LOCI"),
                          nrows = 1, stringsAsFactors = FALSE)

# remove duplicate markers
Onemap.filt2 <- FamB.onemap %>%
  distinct(GENOTYPE, .keep_all = TRUE) %>%
  filter(!LOCUS %in% c("*dDocent_Contig_21007", 
                       "*dDocent_Contig_27780", 
                       "*dDocent_Contig_16379",
                       "*dDocent_Contig_27993",
                       "*dDocent_Contig_169675"))

# write filtered input file for Onemap
# need to add extra line back in
con <- file("data/LINKMAP/FamBfilter.onemap", open = "wt")
writeLines(paste(N$N_IND, (nrow(Onemap.filt2))), con)
write.table(Onemap.filt2, con, 
            append = FALSE, quote = FALSE, sep = " ", 
            na = "NA", dec = ".", 
            col.names = FALSE, row.names = FALSE)
close(con)

# import datafile
FamB.Map <- read.outcross(file="data/LINKMAP/FamBfilter.onemap")

# Summary of datafile
FamB.Map

# estimate recombination fraction between all pairs of markers
# creates object of class rf.2pts
FamB.Map.rf.L6.rf35 <- rf.2pts(FamB.Map, LOD = 6, max.rf = 0.35, verbose=TRUE)

# create sequence (list) of all markers to assign to LGs
all.markers <- make.seq(FamB.Map.rf.L6.rf35, "all") 

# assign markers to linkage groups
LGs <- group(all.markers, LOD = 6, max.rf = 0.35)

# define map function
set.map.fun(typ = "haldane")

# create list of separate LGs 
# (convert from class group to class sequence)
LG_list <- lapply(c(1:24), function(LG) {
  make.seq(LGs, LG)
})

# uses compare() to create a framework of most informative markers
# map remaining markers using try.seq()
# this step will take a few hours
LG_ordered <- lapply((LG_list), function(LG){
  order.seq(LG, n.init=6, THRES=3, touchdown=TRUE, tol=10e-2)
})

# create marker order with all markers
LG_final <- lapply((LG_ordered), function(LG){
  make.seq(LG, "force")
})
    
# group all final ordered LGs
FamB.map <- LG_final

# draw map for all LGs
draw.map(FamB.map, names=FALSE, grid=TRUE, cex.mrk=0.7)

# export map to file
write.map(FamB.map, "data/LINKMAP/FamB.fullmap")
FamB.fullmap <- read.table("data/LINKMAP/FamB.fullmap", 
                           skip = 1, header = FALSE) %>%
  mutate(LOCUS = paste(c("*"), V2, sep = "")) %>%
  rename(LG = V1, POSITION = V3) %>%
  select(LOCUS, LG, POSITION)

# create dataframe of removed loci and corresponding loci
match_loc <- anti_join(FamB.onemap, Onemap.filt2) %>%
  rename(MATCHLOC = LOCUS) %>%
  select(MATCHLOC, GENOTYPE) %>% 
  left_join(Onemap.filt2, by = "GENOTYPE") %>%
  select(LOCUS, MATCHLOC)

# add mapping positions
temp <- left_join(match_loc, FamB.fullmap, by = "LOCUS") %>%
  select(MATCHLOC, LG, POSITION) %>%
  rename(LOCUS = MATCHLOC)

# add markers to final map
FamB.fullmap <- bind_rows(FamB.fullmap, temp) %>%
  group_by(LG) %>%
  arrange(POSITION) %>%
  ungroup()

# write output to file
write.table(FamB.fullmap, "results/FamB.fullmap", row.names = FALSE)

```

# Merge Family maps

Load family maps

```{r}

FamA <- read.delim("data/LINKMAP/FamA.fullmap", 
                   stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))

FamB <- read.delim("data/LINKMAP/FamB.fullmap", 
                   header = TRUE, stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))

temp <- bind_rows(FamA, FamB)

all_markers <- unique(temp$LOCUS)

```

Each map consists of 24 linkage groups and a total of `r nrow(FamA_1)` and `r nrow(FamB_1)` markers for Family A and B, respectively with `r length(temp$LOCUS)-length(all_markers)` markers overlapping between the two family maps.

Use LPmerge to create consensus linkage map by merging linkage maps from Family A and B. LPmerge uses linear programming to minimize the mean absolute error between the consensus and family linkage maps; preserve ordering of the markers in the linkage map using linear inequality constraints. When marker order is inconsisten between maps being merged a minimum set of ordinal constraints is delected to resolve the conflicts.

## Merge maps for LG1:

```{r}

LG1_A <- FamA_1 %>%
    filter(LG == 1) %>%
    select(LOCUS, POSITION)

LG1_B <- FamB_1 %>%
    filter(LG == 1) %>%
    select(LOCUS, POSITION)

Maps <- list(LG1_A, LG1_B)

# Start writing to an output file
sink("results/LG1.merge")

# merge
LG1 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

Look at stats:



## Merge maps for LG2:

```{r}

LG2_A <- FamA_1 %>%
    filter(LG == 2) %>%
    select(LOCUS, POSITION)

LG2_B <- FamB_1 %>%
    filter(LG == 5) %>%
    select(LOCUS, POSITION)

Maps <- list(LG2_A, LG2_B)

# Start writing to an output file
sink("results/LG2.merge")

# merge
LG2 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG3:

```{r}

LG3_A <- FamA_1 %>%
    filter(LG == 3) %>%
    select(LOCUS, POSITION)

LG3_B <- FamB_1 %>%
    filter(LG == 2) %>%
    select(LOCUS, POSITION)

Maps <- list(LG3_A, LG3_B)

# Start writing to an output file
sink("results/LG3.merge")

# merge
LG3 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG4:

```{r}

LG4_A <- FamA_1 %>%
    filter(LG == 4) %>%
    select(LOCUS, POSITION)

LG4_B <- FamB_1 %>%
    filter(LG == 13) %>%
    select(LOCUS, POSITION)

Maps <- list(LG4_A, LG4_B)

# Start writing to an output file
sink("results/LG4.merge")

# merge
LG4 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG5:

```{r}

LG5_A <- FamA_1 %>%
    filter(LG == 5) %>%
    select(LOCUS, POSITION)

LG5_B <- FamB_1 %>%
    filter(LG == 8) %>%
    select(LOCUS, POSITION)

Maps <- list(LG5_A, LG5_B)

# Start writing to an output file
sink("results/LG5.merge")

# merge
LG5 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG6:

```{r}

LG6_A <- FamA_1 %>%
    filter(LG == 6) %>%
    select(LOCUS, POSITION)

LG6_B <- FamB_1 %>%
    filter(LG == 11) %>%
    select(LOCUS, POSITION)

Maps <- list(LG6_A, LG6_B)

# Start writing to an output file
sink("results/LG6.merge")

# merge
LG6 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG7:

```{r}

LG7_A <- FamA_1 %>%
    filter(LG == 7) %>%
    select(LOCUS, POSITION)

LG7_B <- FamB_1 %>%
    filter(LG == 3) %>%
    select(LOCUS, POSITION)

Maps <- list(LG7_A, LG7_B)

# Start writing to an output file
sink("results/LG7.merge")

# merge
LG7 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG8:

```{r}

LG8_A <- FamA_1 %>%
    filter(LG == 8) %>%
    select(LOCUS, POSITION)

LG8_B <- FamB_1 %>%
    filter(LG == 24) %>%
    select(LOCUS, POSITION)

Maps <- list(LG8_A, LG8_B)

# Start writing to an output file
sink("results/LG8.merge")

# merge
LG8 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG9:

```{r}

LG9_A <- FamA_1 %>%
    filter(LG == 9) %>%
    select(LOCUS, POSITION)

LG9_B <- FamB_1 %>%
    filter(LG == 17) %>%
    select(LOCUS, POSITION)

Maps <- list(LG9_A, LG9_B)

# Start writing to an output file
sink("results/LG9.merge")

# merge
LG9 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG10:

```{r}

LG10_A <- FamA_1 %>%
    filter(LG == 10) %>%
    select(LOCUS, POSITION)

LG10_B <- FamB_1 %>%
    filter(LG == 6) %>%
    select(LOCUS, POSITION)

Maps <- list(LG10_A, LG10_B)

# Start writing to an output file
sink("results/LG10.merge")

# merge
LG10 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG11:

```{r}

LG11_A <- FamA_1 %>%
    filter(LG == 11) %>%
    select(LOCUS, POSITION)

LG11_B <- FamB_1 %>%
    filter(LG == 18) %>%
    select(LOCUS, POSITION)

Maps <- list(LG11_A, LG11_B)

# Start writing to an output file
sink("results/LG11.merge")

# merge
LG11 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG12:

```{r}

LG12_A <- FamA_1 %>%
    filter(LG == 12) %>%
    select(LOCUS, POSITION)

LG12_B <- FamB_1 %>%
    filter(LG == 10) %>%
    select(LOCUS, POSITION)

Maps <- list(LG12_A, LG12_B)

# Start writing to an output file
sink("results/LG12.merge")

# merge
LG12 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG13:

```{r}

LG13_A <- FamA_1 %>%
    filter(LG == 13) %>%
    select(LOCUS, POSITION)

LG13_B <- FamB_1 %>%
    filter(LG == 7) %>%
    select(LOCUS, POSITION)

Maps <- list(LG13_A, LG13_B)

# Start writing to an output file
sink("results/LG13.merge")

# merge
LG13 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG14:

```{r}

LG14_A <- FamA_1 %>%
    filter(LG == 14) %>%
    select(LOCUS, POSITION)

LG14_B <- FamB_1 %>%
    filter(LG == 4) %>%
    select(LOCUS, POSITION)

Maps <- list(LG14_A, LG14_B)

# Start writing to an output file
sink("results/LG14.merge")

# merge
LG14 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG15:

```{r}

LG15_A <- FamA_1 %>%
    filter(LG == 15) %>%
    select(LOCUS, POSITION)

LG15_B <- FamB_1 %>%
    filter(LG == 12) %>%
    select(LOCUS, POSITION)

Maps <- list(LG15_A, LG15_B)

# Start writing to an output file
sink("results/LG15.merge")

# merge
LG15 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG16:

```{r}

LG16_A <- FamA_1 %>%
    filter(LG == 16) %>%
    select(LOCUS, POSITION)

LG16_B <- FamB_1 %>%
    filter(LG == 9) %>%
    select(LOCUS, POSITION)

Maps <- list(LG16_A, LG16_B)

# Start writing to an output file
sink("results/LG16.merge")

# merge
LG16 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG17:

```{r}

LG17_A <- FamA_1 %>%
    filter(LG == 17) %>%
    select(LOCUS, POSITION)

LG17_B <- FamB_1 %>%
    filter(LG == 15) %>%
    select(LOCUS, POSITION)

Maps <- list(LG17_A, LG17_B)

# Start writing to an output file
sink("results/LG17.merge")

# merge
LG17 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG18:

```{r}

LG18_A <- FamA_1 %>%
    filter(LG == 18) %>%
    select(LOCUS, POSITION)

LG18_B <- FamB_1 %>%
    filter(LG == 14) %>%
    select(LOCUS, POSITION)

Maps <- list(LG18_A, LG18_B)

# Start writing to an output file
sink("results/LG18.merge")

# merge
LG18 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG19:

```{r}

LG19_A <- FamA_1 %>%
    filter(LG == 19) %>%
    select(LOCUS, POSITION)

LG19_B <- FamB_1 %>%
    filter(LG == 16) %>%
    select(LOCUS, POSITION)

Maps <- list(LG19_A, LG19_B)

# Start writing to an output file
sink("results/LG19.merge")

# merge
LG19 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG20:

```{r}

LG20_A <- FamA_1 %>%
    filter(LG == 20) %>%
    select(LOCUS, POSITION)

LG20_B <- FamB_1 %>%
    filter(LG == 19) %>%
    select(LOCUS, POSITION)

Maps <- list(LG20_A, LG20_B)

# Start writing to an output file
sink("results/LG20.merge")

# merge
LG20 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG21:

```{r}

LG21_A <- FamA_1 %>%
    filter(LG == 21) %>%
    select(LOCUS, POSITION)

LG21_B <- FamB_1 %>%
    filter(LG == 21) %>%
    select(LOCUS, POSITION)

Maps <- list(LG21_A, LG21_B)

# Start writing to an output file
sink("results/LG21.merge")

# merge
LG21 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG22:

```{r}

LG22_A <- FamA_1 %>%
    filter(LG == 22) %>%
    select(LOCUS, POSITION)

LG22_B <- FamB_1 %>%
    filter(LG == 23) %>%
    select(LOCUS, POSITION)

Maps <- list(LG22_A, LG22_B)

# Start writing to an output file
sink("results/LG22.merge")

# merge
LG22 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG23:

```{r}

LG23_A <- FamA_1 %>%
    filter(LG == 23) %>%
    select(LOCUS, POSITION)

LG23_B <- FamB_1 %>%
    filter(LG == 20) %>%
    select(LOCUS, POSITION)

Maps <- list(LG23_A, LG23_B)

# Start writing to an output file
sink("results/LG23.merge")

# merge
LG23 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG24:

```{r}

LG24_A <- FamA_1 %>%
    filter(LG == 24) %>%
    select(LOCUS, POSITION)

LG24_B <- FamB_1 %>%
    filter(LG == 22) %>%
    select(LOCUS, POSITION)

Maps <- list(LG24_A, LG24_B)

# Start writing to an output file
sink("results/LG24.merge")

# merge
LG24 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```
