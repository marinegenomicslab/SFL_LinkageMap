---
title: "Comparative Genomics Southern Flounder"
output:
  html_notebook:
    code_folding: hide
    df_print: paged
    highlight: kate
    theme: flatly
    toc: yes
  html_document:
    toc: yes
---

```{r load libraries, message=FALSE, warning=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

source("lib/libraries.R")
source("lib/ggplot.R")

```

# Compare female, male and family map for Family A

Load maps:

```{r}

FamA_F <- read.delim("results/FamA_F.map", 
                   stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))

FamA_M <- read.delim("results/FamA_M.map", 
                   header = TRUE, stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))

FamA <- read.delim("results/FamA.fullmap", 
                   header = TRUE, stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))



```

# Merge Family maps

Load family maps

```{r}

FamA_1 <- read.delim("data/LINKMAP/FamA.fullmap", 
                   stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))

FamB_1 <- read.delim("data/LINKMAP/FamB.fullmap", 
                   header = TRUE, stringsAsFactors = FALSE, sep = "", 
                   col.names = c("LG", "LOCUS", "POSITION"))

temp <- bind_rows(FamA_1, FamB_1)

all_markers <- unique(temp$LOCUS)

```

Each map consists of 24 linkage groups and a total of `r nrow(FamA_1)` and `r nrow(FamB_1)` markers for Family A and B, respectively with `r length(temp$LOCUS)-length(all_markers)` markers overlapping between the two family maps.

Use LPmerge to create consensus linkage map by merging linkage maps from Family A and B. LPmerge uses linear programming to minimize the mean absolute error between the consensus and family linkage maps; preserve ordering of the markers in the linkage map using linear inequality constraints. When marker order is inconsisten between maps being merged a minimum set of ordinal constraints is delected to resolve the conflicts.

## Merge maps for LG1:

```{r}

LG1_A <- FamA_1 %>%
    filter(LG == 1) %>%
    select(LOCUS, POSITION)

LG1_B <- FamB_1 %>%
    filter(LG == 1) %>%
    select(LOCUS, POSITION)

Maps <- list(LG1_A, LG1_B)

# Start writing to an output file
sink("results/LG1.merge")

# merge
LG1 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

Look at stats:



## Merge maps for LG2:

```{r}

LG2_A <- FamA_1 %>%
    filter(LG == 2) %>%
    select(LOCUS, POSITION)

LG2_B <- FamB_1 %>%
    filter(LG == 5) %>%
    select(LOCUS, POSITION)

Maps <- list(LG2_A, LG2_B)

# Start writing to an output file
sink("results/LG2.merge")

# merge
LG2 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG3:

```{r}

LG3_A <- FamA_1 %>%
    filter(LG == 3) %>%
    select(LOCUS, POSITION)

LG3_B <- FamB_1 %>%
    filter(LG == 2) %>%
    select(LOCUS, POSITION)

Maps <- list(LG3_A, LG3_B)

# Start writing to an output file
sink("results/LG3.merge")

# merge
LG3 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG4:

```{r}

LG4_A <- FamA_1 %>%
    filter(LG == 4) %>%
    select(LOCUS, POSITION)

LG4_B <- FamB_1 %>%
    filter(LG == 13) %>%
    select(LOCUS, POSITION)

Maps <- list(LG4_A, LG4_B)

# Start writing to an output file
sink("results/LG4.merge")

# merge
LG4 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG5:

```{r}

LG5_A <- FamA_1 %>%
    filter(LG == 5) %>%
    select(LOCUS, POSITION)

LG5_B <- FamB_1 %>%
    filter(LG == 8) %>%
    select(LOCUS, POSITION)

Maps <- list(LG5_A, LG5_B)

# Start writing to an output file
sink("results/LG5.merge")

# merge
LG5 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG6:

```{r}

LG6_A <- FamA_1 %>%
    filter(LG == 6) %>%
    select(LOCUS, POSITION)

LG6_B <- FamB_1 %>%
    filter(LG == 11) %>%
    select(LOCUS, POSITION)

Maps <- list(LG6_A, LG6_B)

# Start writing to an output file
sink("results/LG6.merge")

# merge
LG6 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG7:

```{r}

LG7_A <- FamA_1 %>%
    filter(LG == 7) %>%
    select(LOCUS, POSITION)

LG7_B <- FamB_1 %>%
    filter(LG == 3) %>%
    select(LOCUS, POSITION)

Maps <- list(LG7_A, LG7_B)

# Start writing to an output file
sink("results/LG7.merge")

# merge
LG7 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG8:

```{r}

LG8_A <- FamA_1 %>%
    filter(LG == 8) %>%
    select(LOCUS, POSITION)

LG8_B <- FamB_1 %>%
    filter(LG == 24) %>%
    select(LOCUS, POSITION)

Maps <- list(LG8_A, LG8_B)

# Start writing to an output file
sink("results/LG8.merge")

# merge
LG8 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG9:

```{r}

LG9_A <- FamA_1 %>%
    filter(LG == 9) %>%
    select(LOCUS, POSITION)

LG9_B <- FamB_1 %>%
    filter(LG == 17) %>%
    select(LOCUS, POSITION)

Maps <- list(LG9_A, LG9_B)

# Start writing to an output file
sink("results/LG9.merge")

# merge
LG9 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG10:

```{r}

LG10_A <- FamA_1 %>%
    filter(LG == 10) %>%
    select(LOCUS, POSITION)

LG10_B <- FamB_1 %>%
    filter(LG == 6) %>%
    select(LOCUS, POSITION)

Maps <- list(LG10_A, LG10_B)

# Start writing to an output file
sink("results/LG10.merge")

# merge
LG10 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG11:

```{r}

LG11_A <- FamA_1 %>%
    filter(LG == 11) %>%
    select(LOCUS, POSITION)

LG11_B <- FamB_1 %>%
    filter(LG == 18) %>%
    select(LOCUS, POSITION)

Maps <- list(LG11_A, LG11_B)

# Start writing to an output file
sink("results/LG11.merge")

# merge
LG11 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG12:

```{r}

LG12_A <- FamA_1 %>%
    filter(LG == 12) %>%
    select(LOCUS, POSITION)

LG12_B <- FamB_1 %>%
    filter(LG == 10) %>%
    select(LOCUS, POSITION)

Maps <- list(LG12_A, LG12_B)

# Start writing to an output file
sink("results/LG12.merge")

# merge
LG12 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG13:

```{r}

LG13_A <- FamA_1 %>%
    filter(LG == 13) %>%
    select(LOCUS, POSITION)

LG13_B <- FamB_1 %>%
    filter(LG == 7) %>%
    select(LOCUS, POSITION)

Maps <- list(LG13_A, LG13_B)

# Start writing to an output file
sink("results/LG13.merge")

# merge
LG13 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG14:

```{r}

LG14_A <- FamA_1 %>%
    filter(LG == 14) %>%
    select(LOCUS, POSITION)

LG14_B <- FamB_1 %>%
    filter(LG == 4) %>%
    select(LOCUS, POSITION)

Maps <- list(LG14_A, LG14_B)

# Start writing to an output file
sink("results/LG14.merge")

# merge
LG14 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG15:

```{r}

LG15_A <- FamA_1 %>%
    filter(LG == 15) %>%
    select(LOCUS, POSITION)

LG15_B <- FamB_1 %>%
    filter(LG == 12) %>%
    select(LOCUS, POSITION)

Maps <- list(LG15_A, LG15_B)

# Start writing to an output file
sink("results/LG15.merge")

# merge
LG15 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG16:

```{r}

LG16_A <- FamA_1 %>%
    filter(LG == 16) %>%
    select(LOCUS, POSITION)

LG16_B <- FamB_1 %>%
    filter(LG == 9) %>%
    select(LOCUS, POSITION)

Maps <- list(LG16_A, LG16_B)

# Start writing to an output file
sink("results/LG16.merge")

# merge
LG16 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG17:

```{r}

LG17_A <- FamA_1 %>%
    filter(LG == 17) %>%
    select(LOCUS, POSITION)

LG17_B <- FamB_1 %>%
    filter(LG == 15) %>%
    select(LOCUS, POSITION)

Maps <- list(LG17_A, LG17_B)

# Start writing to an output file
sink("results/LG17.merge")

# merge
LG17 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG18:

```{r}

LG18_A <- FamA_1 %>%
    filter(LG == 18) %>%
    select(LOCUS, POSITION)

LG18_B <- FamB_1 %>%
    filter(LG == 14) %>%
    select(LOCUS, POSITION)

Maps <- list(LG18_A, LG18_B)

# Start writing to an output file
sink("results/LG18.merge")

# merge
LG18 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG19:

```{r}

LG19_A <- FamA_1 %>%
    filter(LG == 19) %>%
    select(LOCUS, POSITION)

LG19_B <- FamB_1 %>%
    filter(LG == 16) %>%
    select(LOCUS, POSITION)

Maps <- list(LG19_A, LG19_B)

# Start writing to an output file
sink("results/LG19.merge")

# merge
LG19 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG20:

```{r}

LG20_A <- FamA_1 %>%
    filter(LG == 20) %>%
    select(LOCUS, POSITION)

LG20_B <- FamB_1 %>%
    filter(LG == 19) %>%
    select(LOCUS, POSITION)

Maps <- list(LG20_A, LG20_B)

# Start writing to an output file
sink("results/LG20.merge")

# merge
LG20 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG21:

```{r}

LG21_A <- FamA_1 %>%
    filter(LG == 21) %>%
    select(LOCUS, POSITION)

LG21_B <- FamB_1 %>%
    filter(LG == 21) %>%
    select(LOCUS, POSITION)

Maps <- list(LG21_A, LG21_B)

# Start writing to an output file
sink("results/LG21.merge")

# merge
LG21 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG22:

```{r}

LG22_A <- FamA_1 %>%
    filter(LG == 22) %>%
    select(LOCUS, POSITION)

LG22_B <- FamB_1 %>%
    filter(LG == 23) %>%
    select(LOCUS, POSITION)

Maps <- list(LG22_A, LG22_B)

# Start writing to an output file
sink("results/LG22.merge")

# merge
LG22 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG23:

```{r}

LG23_A <- FamA_1 %>%
    filter(LG == 23) %>%
    select(LOCUS, POSITION)

LG23_B <- FamB_1 %>%
    filter(LG == 20) %>%
    select(LOCUS, POSITION)

Maps <- list(LG23_A, LG23_B)

# Start writing to an output file
sink("results/LG23.merge")

# merge
LG23 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```

## Merge maps for LG24:

```{r}

LG24_A <- FamA_1 %>%
    filter(LG == 24) %>%
    select(LOCUS, POSITION)

LG24_B <- FamB_1 %>%
    filter(LG == 22) %>%
    select(LOCUS, POSITION)

Maps <- list(LG24_A, LG24_B)

# Start writing to an output file
sink("results/LG24.merge")

# merge
LG24 <- LPmerge(Maps, max.interval = 1:50, weights = NULL)

# Stop writing to the file
sink()

```
